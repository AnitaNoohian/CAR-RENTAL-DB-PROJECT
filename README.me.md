# سیستم مدیریت اجاره خودرو (Car Rental Management System)

این پروژه یک **سیستم مدیریت اجاره خودرو مبتنی بر وب** است که با استفاده
از Flask و PostgreSQL پیاده‌سازی شده است.\
این سیستم به‌عنوان یک **پنل داخلی مدیریتی** طراحی شده و هدف آن مدیریت
کامل خودروها، مشتریان، اجاره‌ها و رسیدهای مالی در یک شرکت اجاره خودرو
است.

تمرکز اصلی پروژه بر:

-   طراحی صحیح پایگاه داده
-   پیاده‌سازی منطقی فرآیند اجاره
-   مدیریت صحیح تراکنش‌های دیتابیس
-   کنترل خطا (Error Handling)
-   ساختار ماژولار و خوانا

------------------------------------------------------------------------
## امکانات سیستم

### احراز هویت (Authentication)

-   ورود ادمین
-   کنترل دسترسی به تمام بخش‌های سیستم
-   مدیریت Session
-   بررسی خالی بودن ورودی‌ها
-   مدیریت خطاهای پایگاه داده هنگام ورود

> این سیستم پنل عمومی مشتریان نیست و صرفاً برای استفاده داخلی طراحی شده
> است.

------------------------------------------------------------------------

### مدیریت خودروها

-   افزودن خودرو جدید
-   ویرایش اطلاعات خودرو
-   حذف خودرو
-   مشاهده جزئیات خودرو
-   بررسی و نغییر وضعیت اجاره (`is_rented`)
-   جلوگیری از ثبت پلاک تکراری
-   مدیریت خطاهای دیتابیس (UniqueViolation و ...)

اطلاعات هر خودرو:

-   نام خودرو
-   شماره پلاک (Unique)
-   رنگ (اختیاری)
-   نوع سوخت
-   میزان مصرف سوخت (اختیاری)
-   وضعیت اجاره

> موقعیت عکس در صفحه جزییات ماشین وجود دارد ولی در دیتابیس گذاشته نشده است!
------------------------------------------------------------------------

### مدیریت مشتریان

-   ثبت مشتری جدید
-   ویرایش اطلاعات مشتری
-   جلوگیری از ثبت کد ملی تکراری
-   مدیریت چند جدول مرتبط (client و client_phone)

------------------------------------------------------------------------

### مدیریت اجاره (Rent)

-   ثبت اجاره جدید
-   اتصال هر اجاره به:
    -   یک خودرو
    -   یک مشتری
    -   یک کارمند
-   فقط خودروهای آزاد قابل انتخاب هستند
-   ثبت خودکار تاریخ ثبت (`registration_date`)
-   ثبت `km_start`

------------------------------------------------------------------------

### پایان اجاره

در پایان اجاره:

-   ثبت `km_end`
-   ثبت قیمت روزانه
-   ثبت هزینه خسارت (اختیاری)

سیستم به‌صورت خودکار:

-   تعداد روزهای اجاره را محاسبه می‌کند
-   مبلغ نهایی را محاسبه می‌کند
-   رسید را ثبت می‌کند
-   وضعیت خودرو را آزاد می‌کند

> یک اجاره زمانی پایان‌یافته محسوب می‌شود که `km_end` مقدار داشته باشد.

------------------------------------------------------------------------

### مدیریت رسید (Receipt)

-   ایجاد خودکار رسید هنگام ثبت اجاره
-   تکمیل اطلاعات مالی در زمان پایان اجاره
-   محاسبه خودکار `total_price`
-  جلوگیری از ویرایش رسید
-   مدیریت خطاهای ورودی عددی

------------------------------------------------------------------------

### داشبورد مدیریتی

نمایش آمار کلی سیستم:

-   تعداد کل خودروها
-   خودروهای در حال اجاره
-   خودروهای آزاد
-   تعداد مشتریان
-   رسیدهای پرداخت‌نشده
-   مجموع درآمد کل
-   ۵ اجاره اخیر

------------------------------------------------------------------------

## ساختار پروژه

    CARRENTALDB_PHASE5
    │
    ├── routes/
    │   ├── auth.py
    │   ├── car_routes.py
    │   ├── client_routes.py
    │   ├── dashboard_routes.py
    │   ├── receipt_routes.py
    │   └── rent_routes.py
    │
    ├── templates/
    │   ├── layout.html
    │   ├── login.html
    │   ├── dashboard.html
    │   ├── cars.html
    │   ├── car_detail.html
    │   ├── edit_car.html
    │   ├── clients.html
    │   ├── client_form.html
    │   ├── rents.html
    │   ├── add_rent.html
    │   ├── finish_rent.html
    │   ├── receipts.html
    │   ├── view_receipt.html
    │   └── edit_receipt.html
    │
    ├── app.py
    ├── db.py
    ├── requirements.txt
    ├── venv/
    └── README.me


------------------------------------------------------------------------

## معماری پروژه

پروژه با استفاده از **Flask Blueprints** به‌صورت ماژولار طراحی شده است:

-   هر بخش (car, rent, receipt, client, auth, dashboard) دارای route
    جداگانه است.
-   کدها از هم تفکیک شده‌اند و خوانایی بالا دارند.
-   مدیریت تراکنش‌ها با استفاده از `try / except / rollback` انجام می‌شود.
-   تمامی عملیات حساس دیتابیس دارای کنترل خطا هستند.

------------------------------------------------------------------------

## مدیریت خطا (Error Handling)

در کل پروژه:

-   استفاده از `try / except psycopg2.Error`
-   استفاده از `rollback` در صورت خطا
-   اعتبارسنجی ورودی‌های عددی
-   جلوگیری از ورود داده‌های ناقص

------------------------------------------------------------------------

## تکنولوژی‌های استفاده‌شده

-   Python 3
-   Flask
-   PostgreSQL
-   psycopg2
-   HTML + Jinja2
-   Bootstrap 5

------------------------------------------------------------------------

### آنیتا نوحیان - علوم کامپیوتر - 402222151

-----------------------------------------------------------------------
------------------------------------------------------------------------
